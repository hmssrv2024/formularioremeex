<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>REMEEX Visa Payment Gateway</title>
  <link rel="icon" href="https://w7.pngwing.com/pngs/400/28/png-transparent-credit-card-computer-icons-visa-electron-bank-curio-blue-text-rectangle-thumbnail.png" type="image/png">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/v-mask@2.3.0/dist/v-mask.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/gsap@3.11.4/dist/gsap.min.js"></script>

  <style>
    :root {
      /* Main colors - modernized neumorphic palette */
      --primary: #1a1f71; /* Visa blue */
      --primary-dark: #0d153e;
      --primary-light: #2c348e;
      --secondary: #3b82f6;
      --accent: #60a5fa;
      --success: #10b981;
      --success-dark: #059669;
      --danger: #ef4444;
      --danger-dark: #dc2626;
      --warning: #f59e0b;
      --warning-dark: #d97706;

      /* Neumorphic base colors */
      --base-color: #eef2f6;
      --base-color-dark: #d4dae0;
      --base-color-light: #ffffff;
      
      /* Neumorphic shadows */
      --light-shadow: rgba(255, 255, 255, 0.8);
      --dark-shadow: rgba(174, 184, 192, 0.3);

      /* Neon effects */
      --neon-green: #10b981;
      --neon-green-glow: rgba(16, 185, 129, 0.5);

      /* Backgrounds and text */
      --background: var(--base-color);
      --card-bg: var(--base-color);
      --text-primary: #1e293b;
      --text-secondary: #475569;
      --text-light: #94a3b8;
      --text-white: #ffffff;

      /* Design elements */
      --border-radius-xl: 28px;
      --border-radius-lg: 20px;
      --border-radius: 16px;
      --border-radius-sm: 12px;
      --neumorphic-shadow: 
        10px 10px 20px var(--dark-shadow),
        -10px -10px 20px var(--light-shadow);
      --neumorphic-shadow-small: 
        5px 5px 10px var(--dark-shadow),
        -5px -5px 10px var(--light-shadow);
      --neumorphic-shadow-inset: 
        inset 5px 5px 10px var(--dark-shadow),
        inset -5px -5px 10px var(--light-shadow);
      --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      --transition-bounce: all 0.5s cubic-bezier(0.68, -0.55, 0.27, 1.55);
    }

    /* Animation keyframes */
    @keyframes glow {
      0%, 100% {
        box-shadow: 0 0 30px rgba(26, 31, 113, 0.3), 0 0 60px rgba(26, 31, 113, 0.2);
      }
      50% {
        box-shadow: 0 0 50px rgba(26, 31, 113, 0.5), 0 0 80px rgba(26, 31, 113, 0.3);
      }
    }

    @keyframes border-blink {
      0%   { border-color: rgba(255, 255, 255, 0.7); }
      33%  { border-color: rgba(209, 213, 219, 0.7); }
      66%  { border-color: rgba(96, 165, 250, 0.7); }
      100% { border-color: rgba(255, 255, 255, 0.7); }
    }

    @keyframes pulse {
      0% { transform: scale(1); box-shadow: var(--neumorphic-shadow); }
      70% { transform: scale(1.03); box-shadow: 0 0 0 10px rgba(26, 31, 113, 0); }
      100% { transform: scale(1); box-shadow: var(--neumorphic-shadow); }
    }

    @keyframes shimmer {
      100% { transform: translateX(100%); }
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    @keyframes slideDown {
      from {
        transform: translateY(-30px);
        opacity: 0;
      }
      to {
        transform: translateY(0);
        opacity: 1;
      }
    }

    @keyframes pulseGlow {
      0%   { transform: translate(-50%, -50%) scale(1); opacity: 0.8; }
      50%  { transform: translate(-50%, -50%) scale(1.5); opacity: 0.3; }
      100% { transform: translate(-50%, -50%) scale(1); opacity: 0.8; }
    }

    @keyframes circleExpand {
      0% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
      100% { transform: translate(-50%, -50%) scale(50); opacity: 0; }
    }

    @keyframes otp-pulse {
      0% { transform: scale(1); opacity: 1; }
      50% { transform: scale(1.05); opacity: 0.9; }
      100% { transform: scale(1); opacity: 1; }
    }

    /* Base styles */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Montserrat', sans-serif;
      background: var(--background);
      color: var(--text-primary);
      line-height: 1.6;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 1.5rem;
    }

    .container {
      max-width: 1100px;
      width: 100%;
      margin: 2rem auto;
      display: flex;
      flex-direction: column;
      gap: 2rem;
    }

    /* Neumorphic card styles */
    .card {
      background: var(--card-bg);
      border-radius: var(--border-radius-lg);
      padding: 2.5rem;
      box-shadow: var(--neumorphic-shadow);
      overflow: hidden;
      position: relative;
      transition: var(--transition);
    }

    .card:hover {
      transform: translateY(-5px);
    }

    .card-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 2rem;
      padding-bottom: 1.5rem;
      border-bottom: 1px solid rgba(226, 232, 240, 0.3);
    }

    .card-header img {
      height: 40px;
    }

    .card-title {
      font-size: 1.5rem;
      font-weight: 600;
      color: var(--primary);
      margin-bottom: 0.5rem;
    }

    .card-description {
      color: var(--text-secondary);
      font-size: 0.95rem;
      margin-bottom: 1.5rem;
    }

    /* Two column layout for desktop */
    .form-container {
      display: flex;
      flex-direction: column;
      gap: 2rem;
    }

    @media (min-width: 992px) {
      .form-container {
        flex-direction: row;
      }
      
      .form-left, .form-right {
        flex: 1;
      }
      
      .form-left {
        padding-right: 2rem;
        border-right: 1px solid rgba(226, 232, 240, 0.3);
      }
    }

    /* Form elements - neumorphic style */
    .form-group {
      margin-bottom: 1.8rem;
    }

    .form-label {
      display: block;
      font-size: 0.9rem;
      font-weight: 600;
      color: var(--text-secondary);
      margin-bottom: 0.8rem;
      padding-left: 0.5rem;
    }

    .form-control {
      width: 100%;
      padding: 1rem 1.25rem;
      border: none;
      border-radius: var(--border-radius);
      font-size: 1rem;
      background: var(--base-color);
      color: var(--text-primary);
      font-family: 'Montserrat', sans-serif;
      font-weight: 500;
      box-shadow: var(--neumorphic-shadow-inset);
      transition: var(--transition);
    }

    .form-control:focus {
      outline: none;
      box-shadow: inset 4px 4px 8px var(--dark-shadow),
                  inset -4px -4px 8px var(--light-shadow),
                  0 0 0 3px rgba(26, 31, 113, 0.1);
    }

    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 1rem 1.75rem;
      border-radius: var(--border-radius);
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition);
      border: none;
      font-size: 1rem;
      box-shadow: var(--neumorphic-shadow-small);
      position: relative;
      overflow: hidden;
      font-family: 'Montserrat', sans-serif;
    }

    .btn:active {
      box-shadow: var(--neumorphic-shadow-inset);
      transform: translateY(1px);
    }

    .btn-primary {
      background: var(--primary);
      color: white;
    }

    .btn-primary:hover {
      background: var(--primary-dark);
      transform: translateY(-3px);
    }

    .btn-primary:active {
      transform: translateY(1px);
      background: var(--primary-dark);
    }

    .btn-secondary {
      background: var(--base-color);
      color: var(--primary);
    }

    .btn-secondary:hover {
      transform: translateY(-3px);
      color: var(--primary-dark);
    }

    .btn-block {
      width: 100%;
    }

    .btn i {
      margin-right: 0.5rem;
    }

    /* OTP input styles */
    .otp-container {
      display: flex;
      gap: 0.5rem;
      margin: 2rem 0;
      justify-content: center;
    }

    .otp-input {
      width: 3.5rem;
      height: 3.5rem;
      font-size: 1.8rem;
      text-align: center;
      border: none;
      border-radius: var(--border-radius);
      background: var(--base-color);
      color: var(--primary);
      font-weight: 600;
      box-shadow: var(--neumorphic-shadow-inset);
      transition: all 0.3s ease;
    }

    .otp-input:focus {
      outline: none;
      box-shadow: inset 4px 4px 8px var(--dark-shadow),
                  inset -4px -4px 8px var(--light-shadow),
                  0 0 0 3px rgba(26, 31, 113, 0.1);
      animation: otp-pulse 0.8s ease-in-out;
    }

    /* Exchange rate and balance info */
    .fixed-amount-container {
      background: var(--base-color);
      padding: 2rem;
      border-radius: var(--border-radius);
      text-align: center;
      margin-bottom: 2.5rem;
      position: relative;
      overflow: hidden;
      box-shadow: var(--neumorphic-shadow-small);
    }

    .exchange-rate-badge {
      position: absolute;
      top: 0;
      right: 0;
      background: var(--primary);
      color: white;
      padding: 0.6rem 1.2rem;
      border-radius: 0 var(--border-radius) 0 var(--border-radius-lg);
      font-size: 0.85rem;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .exchange-rate-badge img {
      height: 16px;
    }

    .fixed-amount-title {
      font-size: 1rem;
      color: var(--text-secondary);
      margin-bottom: 0.8rem;
    }

    .fixed-amount {
      font-size: 2.8rem;
      font-weight: 700;
      color: var(--primary);
      margin-bottom: 0.5rem;
    }

    .fixed-amount-equivalent {
      font-size: 1.2rem;
      color: var(--text-secondary);
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
    }

    .fixed-amount-equivalent img {
      height: 18px;
    }

    /* Credit card design - neumorphic style */
    .credit-card-form {
      max-width: 500px;
      margin: 0 auto;
    }

    .card-item {
      max-width: 430px;
      height: 270px;
      margin: 0 auto 2rem;
      position: relative;
      z-index: 2;
      width: 100%;
      perspective: 1000px;
    }

    .card-item.-active .card-item__side.-front {
      transform: rotateY(180deg);
    }

    .card-item.-active .card-item__side.-back {
      transform: rotateY(0);
    }

    .card-item__side {
      border-radius: 20px;
      overflow: hidden;
      box-shadow: 0 15px 30px rgba(14, 42, 90, 0.3);
      transform-style: preserve-3d;
      transition: all 0.8s cubic-bezier(0.71, 0.03, 0.56, 0.85);
      backface-visibility: hidden;
      height: 100%;
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
    }

    .card-item__side.-back {
      transform: rotateY(-180deg);
    }

    .card-item__bg {
      max-width: 100%;
      display: block;
      max-height: 100%;
      height: 100%;
      width: 100%;
      object-fit: cover;
    }

    .card-item__cover {
      height: 100%;
      background-color: var(--primary);
      position: absolute;
      height: 100%;
      left: 0;
      top: 0;
      width: 100%;
      border-radius: 20px;
      overflow: hidden;
    }

    .card-item__cover:after {
      content: "";
      position: absolute;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background: rgba(6, 2, 29, 0.45);
    }

    .card-item__wrapper {
      padding: 25px 15px;
      position: relative;
      z-index: 4;
      height: 100%;
      text-shadow: 7px 6px 10px rgba(14, 42, 90, 0.8);
      user-select: none;
    }

    .card-item__top {
      display: flex;
      align-items: flex-start;
      justify-content: space-between;
      margin-bottom: 40px;
      padding: 0 10px;
    }

    .card-item__chip {
      width: 60px;
    }

    .card-item__type {
      height: 45px;
      position: relative;
      display: flex;
      justify-content: flex-end;
      max-width: 100px;
      margin-left: auto;
      width: 100%;
    }

    .card-item__typeImg {
      max-width: 100%;
      object-fit: contain;
      max-height: 100%;
      object-position: top right;
    }

    .card-item__info {
      color: #fff;
      width: 100%;
      max-width: calc(100% - 85px);
      padding: 10px 15px;
      font-weight: 500;
      display: block;
      cursor: pointer;
    }

    .card-item__holder {
      opacity: 0.7;
      font-size: 13px;
      margin-bottom: 6px;
    }

    .card-item__name {
      font-size: 18px;
      line-height: 1;
      white-space: nowrap;
      max-width: 100%;
      overflow: hidden;
      text-overflow: ellipsis;
      text-transform: uppercase;
    }

    .card-item__nameItem {
      display: inline-block;
      min-width: 8px;
      position: relative;
    }

    .card-item__number {
      font-weight: 500;
      line-height: 1;
      color: #fff;
      font-size: 27px;
      margin-bottom: 35px;
      display: inline-block;
      padding: 10px 15px;
      cursor: pointer;
    }

    .card-item__numberItem {
      width: 16px;
      display: inline-block;
    }

    .card-item__numberItem.-active {
      width: 30px;
    }

    .card-item__content {
      color: #fff;
      display: flex;
      align-items: flex-start;
    }

    .card-item__date {
      flex-wrap: wrap;
      font-size: 18px;
      margin-left: auto;
      padding: 10px;
      display: inline-flex;
      width: 80px;
      white-space: nowrap;
      flex-shrink: 0;
      cursor: pointer;
    }

    .card-item__dateItem {
      position: relative;
    }

    .card-item__dateItem span {
      width: 22px;
      display: inline-block;
    }

    .card-item__dateTitle {
      opacity: 0.7;
      font-size: 13px;
      padding-bottom: 6px;
      width: 100%;
    }

    .card-item__band {
      background: rgba(0, 0, 19, 0.8);
      width: 100%;
      height: 50px;
      margin-top: 30px;
      position: relative;
      z-index: 2;
    }

    .card-item__cvv {
      text-align: right;
      position: relative;
      z-index: 2;
      padding: 15px;
    }

    .card-item__cvv .card-item__type {
      opacity: 0.7;
    }

    .card-item__cvvTitle {
      padding-right: 10px;
      font-size: 15px;
      font-weight: 500;
      color: #fff;
      margin-bottom: 5px;
    }

    .card-item__cvvBand {
      height: 45px;
      background: #fff;
      margin-bottom: 30px;
      text-align: right;
      display: flex;
      align-items: center;
      justify-content: flex-end;
      padding-right: 10px;
      color: #1a3b5d;
      font-size: 18px;
      border-radius: 4px;
      box-shadow: 0px 10px 20px -7px rgba(32, 56, 117, 0.35);
    }

    /* Login Form - Neumorphic style */
    .login-form {
      max-width: 450px;
      margin: 0 auto;
      padding: 2.5rem;
      border-radius: var(--border-radius-lg);
    }

    .login-form .form-group:last-child {
      margin-bottom: 0;
    }

    .login-title {
      text-align: center;
      margin-bottom: 2rem;
      color: var(--primary);
      font-weight: 700;
    }

    /* Animation container */
    #animation-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: #000;
      z-index: 1000;
      display: none;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      overflow: hidden;
    }

    #animation-content {
      position: relative;
      z-index: 30;
      text-align: center;
      background-color: rgba(255, 255, 255, 0);
      padding: 2.5rem;
      border-radius: var(--border-radius-xl);
      box-shadow: 0 0 50px rgba(255, 255, 255, 0.2);
      animation: glow 3s linear infinite;
      width: 90%;
      max-width: 400px;
      border: 2px solid #ffffff;
      transition: background-color 3s ease;
    }

    #animation-content.card-white {
      background-color: rgba(255,255,255,0.95);
    }

    /* Explosion Canvas */
    #explosion-canvas,
    #vortex-canvas,
    #confetti-canvas,
    #flash-canvas {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
    }

    #explosion-canvas { z-index: 1; }
    #vortex-canvas { z-index: 2; }
    #confetti-canvas { z-index: 20; }
    #flash-canvas { z-index: 25; }

    .checkmark {
      width: 100px;
      height: 100px;
      border-radius: 50%;
      background: var(--success);
      margin: 0 auto 1.25rem;
      position: relative;
      opacity: 0;
      transition: opacity 0.5s;
    }

    .checkmark::before {
      content: "";
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%) scale(1);
      width: 100%;
      height: 100%;
      border-radius: 50%;
      background: radial-gradient(circle, 
        rgba(255, 0, 0, 0.5), 
        rgba(255, 165, 0, 0.5), 
        rgba(255, 255, 0, 0.5), 
        rgba(0, 255, 0, 0.5), 
        rgba(0, 255, 255, 0.5), 
        rgba(0, 0, 255, 0.5), 
        rgba(128, 0, 128, 0.5)
      );
      z-index: -1;
      animation: pulseGlow 2s infinite ease-in-out;
    }

    .checkmark::after {
      content: "\2713";
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 60px;
      font-weight: 700;
      color: #fff;
    }

    .checkmark.expand {
      animation: circleExpand 1.5s forwards;
    }

    #success-message {
      font-size: 2rem;
      margin: 1.25rem 0;
      color: var(--primary);
      font-weight: 600;
      opacity: 0;
      transition: opacity 1s, transform 1s;
    }

    #balance-amount {
      font-size: 3rem;
      margin: 0.5rem 0;
      color: var(--primary);
      font-weight: 700;
      opacity: 0;
      transition: opacity 1s, transform 1s;
    }

    .success-text {
      font-size: 1.25rem;
      margin-top: 0.625rem;
      color: var(--primary);
      font-weight: 600;
      opacity: 0;
      transition: opacity 1s, transform 1s;
    }

    .instructions-text {
      font-size: 1.25rem;
      margin-top: 1rem;
      color: var(--primary);
      opacity: 0;
      transition: opacity 1s, transform 1s;
    }

    .visa-logo {
      margin-top: 1.25rem;
      height: 40px;
      opacity: 0;
      transition: opacity 1s, transform 1s;
    }

    .continue-btn {
      margin-top: 1.5rem;
      animation: pulse 2s infinite;
      position: relative;
      overflow: hidden;
      opacity: 0;
      transition: opacity 1s;
    }

    .continue-btn:hover {
      animation-play-state: paused;
    }

    /* Loading overlay */
    .loading-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.8);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1000;
      flex-direction: column;
      display: none;
    }

    .loading-text {
      color: white;
      font-size: 1.2rem;
      margin-top: 2rem;
      text-align: center;
    }

    /* Advanced loading spinner */
    .spinner-advanced {
      width: 60px;
      height: 60px;
      margin: 1.5rem auto;
      position: relative;
    }
    
    .spinner-ring {
      width: 100%;
      height: 100%;
      border-radius: 50%;
      border: 4px solid transparent;
      border-top-color: var(--primary);
      border-right-color: var(--secondary);
      animation: spinnerRotate 1.5s linear infinite;
      position: absolute;
      top: 0;
      left: 0;
    }
    
    .spinner-ring:nth-child(2) {
      width: 80%;
      height: 80%;
      top: 10%;
      left: 10%;
      border-top-color: var(--secondary);
      border-left-color: var(--primary);
      animation-duration: 2s;
      animation-direction: reverse;
    }
    
    .spinner-ring:nth-child(3) {
      width: 60%;
      height: 60%;
      top: 20%;
      left: 20%;
      border-bottom-color: var(--primary);
      border-left-color: var(--secondary);
      animation-duration: 2.5s;
    }
    
    .spinner-dot {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 15px;
      height: 15px;
      background: linear-gradient(135deg, var(--primary), var(--secondary));
      border-radius: 50%;
      animation: pulse 1.5s cubic-bezier(0.455, 0.03, 0.515, 0.955) infinite alternate;
    }
    
    @keyframes spinnerRotate {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* Progress bar for loading animation */
    .progress-container {
      width: 80%;
      max-width: 300px;
      height: 15px;
      background-color: rgba(255, 255, 255, 0.2);
      border-radius: 30px;
      margin: 1.5rem auto;
      overflow: hidden;
      position: relative;
    }
    
    .progress-bar {
      height: 100%;
      border-radius: 30px;
      background: linear-gradient(90deg, var(--primary), var(--accent));
      width: 0%;
      transition: width 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
      position: relative;
      overflow: hidden;
      box-shadow: 0 0 8px rgba(96, 165, 250, 0.5);
    }
    
    .progress-bar::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(
        90deg,
        transparent,
        rgba(255, 255, 255, 0.6),
        transparent
      );
      transform: translateX(-100%);
      animation: shimmer 2s infinite;
    }

    /* Error messages */
    .error-message {
      color: var(--danger);
      font-size: 0.85rem;
      margin-top: 0.5rem;
      display: none;
      padding: 0.5rem;
      border-radius: var(--border-radius-sm);
      background-color: rgba(239, 68, 68, 0.1);
    }

    /* Steps indicator */
    .steps-container {
      display: flex;
      justify-content: center;
      align-items: center;
      margin-bottom: 2rem;
    }

    .step {
      width: 30px;
      height: 30px;
      border-radius: 50%;
      background: var(--base-color);
      box-shadow: var(--neumorphic-shadow-small);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
      color: var(--text-secondary);
      margin: 0 0.5rem;
      position: relative;
    }

    .step.active {
      background: var(--primary);
      color: white;
      box-shadow: 0 0 15px rgba(26, 31, 113, 0.5);
    }

    .step.completed {
      background: var(--success);
      color: white;
    }

    .step:not(:last-child)::after {
      content: '';
      position: absolute;
      right: -1.5rem;
      top: 50%;
      transform: translateY(-50%);
      width: 1.5rem;
      height: 2px;
      background-color: var(--base-color-dark);
    }

    .step.completed:not(:last-child)::after {
      background-color: var(--success);
    }

    /* OTP verification specific styles */
    .otp-verification {
      text-align: center;
      margin-bottom: 2rem;
    }

    .otp-title {
      font-size: 1.25rem;
      font-weight: 600;
      color: var(--primary);
      margin-bottom: 1rem;
    }

    .otp-subtitle {
      color: var(--text-secondary);
      margin-bottom: 2rem;
    }

    .resend-code {
      display: inline-block;
      margin-top: 1rem;
      color: var(--primary);
      font-weight: 500;
      cursor: pointer;
      text-decoration: none;
    }

    .resend-code:hover {
      text-decoration: underline;
    }

    .timer {
      display: block;
      margin-top: 0.5rem;
      color: var(--text-secondary);
      font-size: 0.85rem;
    }

    /* Responsive adjustments */
    @media (max-width: 768px) {
      .container {
        margin: 1rem auto;
      }

      .card {
        padding: 1.5rem;
      }

      .card-header {
        margin-bottom: 1.5rem;
      }

      .card-title {
        font-size: 1.3rem;
      }

      .fixed-amount {
        font-size: 2rem;
      }

      .fixed-amount-equivalent {
        font-size: 1rem;
      }

      .exchange-rate-badge {
        font-size: 0.75rem;
        padding: 0.4rem 0.8rem;
      }

      .otp-input {
        width: 2.5rem;
        height: 2.5rem;
        font-size: 1.4rem;
      }
    }

    @media (max-width: 576px) {
      .card-item {
        height: 220px;
      }

      .card-item__number {
        font-size: 21px;
        margin-bottom: 15px;
        padding: 10px 10px;
      }

      .card-item__top {
        margin-bottom: 25px;
      }

      .card-item__chip {
        width: 50px;
      }

      .card-item__type {
        height: 40px;
        max-width: 90px;
      }

      .card-item__wrapper {
        padding: 20px 10px;
      }

      .card-item__name {
        font-size: 16px;
      }

      #animation-content {
        width: 95%;
      }

      .checkmark {
        width: 80px;
        height: 80px;
      }

      .checkmark::after {
        font-size: 50px;
      }

      #success-message {
        font-size: 1.75rem;
      }

      #balance-amount {
        font-size: 2.5rem;
      }

      .success-text, .instructions-text {
        font-size: 1.1rem;
      }

      .step {
        width: 25px;
        height: 25px;
        font-size: 0.85rem;
      }
    }
  </style>
</head>

<body>
  <!-- Login Section (Initially Visible) -->
  <div class="container" id="login-container">
    <div class="card">
      <div class="card-header">
        <img src="https://cdn.visa.com/v2/assets/images/logos/visa/blue/logo.png" alt="Visa Logo">
        <img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhnBzNdjl6bNp-nIdaiHVENczJhwlJNA7ocsyiOObMmzbu8at0dY5yGcZ9cLxLF39qI6gwNfqBxlkTDC0txVULEwQVwGkeEzN0Jq9MRTRagA48mh18UqTlR4WhsXOLAEZugUyhqJHB19xJgnkpe-S5VOWFgzpKFwctv3XP9XhH41vNTvq0ZS-nik58Qhr-O/s320/remeex.png" alt="REMEEX Logo" style="height: 38px;">
      </div>
      
      <div class="login-form">
        <h2 class="login-title">Acceder a REMEEX Visa</h2>
        <div class="form-group">
          <label class="form-label" for="login-email">Correo electrónico</label>
          <input type="email" class="form-control" id="login-email" placeholder="example@domain.com">
          <div class="error-message" id="email-error">Por favor, introduce un correo electrónico válido.</div>
        </div>
        <div class="form-group">
          <label class="form-label" for="login-password">Contraseña</label>
          <input type="password" class="form-control" id="login-password" placeholder="********">
          <div class="error-message" id="password-error">La contraseña es incorrecta.</div>
        </div>
        <button class="btn btn-primary btn-block" id="login-button">
          <i class="fas fa-sign-in-alt"></i> Iniciar Sesión
        </button>
      </div>
    </div>
  </div>

  <!-- Payment Form (Initially Hidden) -->
  <div class="container" id="payment-container" style="display: none;">
    <div class="card">
      <div class="card-header">
        <img src="https://cdn.visa.com/v2/assets/images/logos/visa/blue/logo.png" alt="Visa Logo">
        <img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhnBzNdjl6bNp-nIdaiHVENczJhwlJNA7ocsyiOObMmzbu8at0dY5yGcZ9cLxLF39qI6gwNfqBxlkTDC0txVULEwQVwGkeEzN0Jq9MRTRagA48mh18UqTlR4WhsXOLAEZugUyhqJHB19xJgnkpe-S5VOWFgzpKFwctv3XP9XhH41vNTvq0ZS-nik58Qhr-O/s320/remeex.png" alt="REMEEX Logo" style="height: 38px;">
      </div>

      <!-- Steps indicator -->
      <div class="steps-container">
        <div class="step completed" id="step-1">1</div>
        <div class="step active" id="step-2">2</div>
        <div class="step" id="step-3">3</div>
      </div>
      
      <h2 class="card-title">Recarga Única REMEEX Visa</h2>
      <p class="card-description">Complete los detalles de su tarjeta para realizar el pago. La información está protegida con encriptación de alto nivel.</p>
      
      <!-- Fixed Amount Display with exchange rate -->
      <div class="fixed-amount-container">
        <div class="exchange-rate-badge">
          <i class="fas fa-exchange-alt"></i> 1 USD = 109.19 
          <img src="https://www.bancodevenezuela.com/wp-content/uploads/2023/03/logonuevo.png" alt="BDV Logo">
        </div>
        <div class="fixed-amount-title">Monto a recargar (USD)</div>
        <div class="fixed-amount">$500.00</div>
        <div class="fixed-amount-equivalent">Equivalente a <img src="https://www.bancodevenezuela.com/wp-content/uploads/2023/03/logonuevo.png" alt="BDV Logo"> 54,595.00</div>
      </div>
      
      <!-- Card Information Form -->
      <div class="form-container" id="app">
        <div class="form-left">
          <div class="card-item" v-bind:class="{ '-active' : isCardFlipped }">
            <div class="card-item__side -front">
              <div class="card-item__focus" v-bind:class="{'-active' : focusElementStyle }" v-bind:style="focusElementStyle" ref="focusElement"></div>
              <div class="card-item__cover">
                <img
                v-bind:src="'https://raw.githubusercontent.com/muhammederdem/credit-card-form/master/src/assets/images/' + currentCardBackground + '.jpeg'" class="card-item__bg">
              </div>
              
              <div class="card-item__wrapper">
                <div class="card-item__top">
                  <img src="https://raw.githubusercontent.com/muhammederdem/credit-card-form/master/src/assets/images/chip.png" class="card-item__chip">
                  <div class="card-item__type">
                    <transition name="slide-fade-up">
                      <img v-bind:src="'https://raw.githubusercontent.com/muhammederdem/credit-card-form/master/src/assets/images/' + getCardType + '.png'" v-if="getCardType" v-bind:key="getCardType" alt="" class="card-item__typeImg">
                    </transition>
                  </div>
                </div>
                <label for="cardNumber" class="card-item__number" ref="cardNumber">
                  <template v-if="getCardType === 'amex'">
                   <span v-for="(n, $index) in amexCardMask" :key="$index">
                    <transition name="slide-fade-up">
                      <div
                        class="card-item__numberItem"
                        v-if="$index > 4 && $index < 14 && cardNumber.length > $index && n.trim() !== ''"
                      >*</div>
                      <div class="card-item__numberItem"
                        :class="{ '-active' : n.trim() === '' }"
                        :key="$index" v-else-if="cardNumber.length > $index">
                        {{cardNumber[$index]}}
                      </div>
                      <div
                        class="card-item__numberItem"
                        :class="{ '-active' : n.trim() === '' }"
                        v-else
                        :key="$index + 1"
                      >{{n}}</div>
                    </transition>
                  </span>
                  </template>

                  <template v-else>
                    <span v-for="(n, $index) in otherCardMask" :key="$index">
                      <transition name="slide-fade-up">
                        <div
                          class="card-item__numberItem"
                          v-if="$index > 4 && $index < 15 && cardNumber.length > $index && n.trim() !== ''"
                        >*</div>
                        <div class="card-item__numberItem"
                          :class="{ '-active' : n.trim() === '' }"
                          :key="$index" v-else-if="cardNumber.length > $index">
                          {{cardNumber[$index]}}
                        </div>
                        <div
                          class="card-item__numberItem"
                          :class="{ '-active' : n.trim() === '' }"
                          v-else
                          :key="$index + 1"
                        >{{n}}</div>
                      </transition>
                    </span>
                  </template>
                </label>
                <div class="card-item__content">
                  <label for="cardName" class="card-item__info" ref="cardName">
                    <div class="card-item__holder">Card Holder</div>
                    <transition name="slide-fade-up">
                      <div class="card-item__name" v-if="cardName.length" key="1">
                        <transition-group name="slide-fade-right">
                          <span class="card-item__nameItem" v-for="(n, $index) in cardName.replace(/\s\s+/g, ' ')" v-if="$index === $index" v-bind:key="$index + 1">{{n}}</span>
                        </transition-group>
                      </div>
                      <div class="card-item__name" v-else key="2">Full Name</div>
                    </transition>
                  </label>
                  <div class="card-item__date" ref="cardDate">
                    <label for="cardMonth" class="card-item__dateTitle">Expires</label>
                    <label for="cardMonth" class="card-item__dateItem">
                      <transition name="slide-fade-up">
                        <span v-if="cardMonth" v-bind:key="cardMonth">{{cardMonth}}</span>
                        <span v-else key="2">MM</span>
                      </transition>
                    </label>
                    /
                    <label for="cardYear" class="card-item__dateItem">
                      <transition name="slide-fade-up">
                        <span v-if="cardYear" v-bind:key="cardYear">{{String(cardYear).slice(2,4)}}</span>
                        <span v-else key="2">YY</span>
                      </transition>
                    </label>
                  </div>
                </div>
              </div>
            </div>
            <div class="card-item__side -back">
              <div class="card-item__cover">
                <img
                v-bind:src="'https://raw.githubusercontent.com/muhammederdem/credit-card-form/master/src/assets/images/' + currentCardBackground + '.jpeg'" class="card-item__bg">
              </div>
              <div class="card-item__band"></div>
              <div class="card-item__cvv">
                  <div class="card-item__cvvTitle">CVV</div>
                  <div class="card-item__cvvBand">
                    <span v-for="(n, $index) in cardCvv" :key="$index">
                      *
                    </span>
                  </div>
                  <div class="card-item__type">
                      <img v-bind:src="'https://raw.githubusercontent.com/muhammederdem/credit-card-form/master/src/assets/images/' + getCardType + '.png'" v-if="getCardType" class="card-item__typeImg">
                  </div>
              </div>
            </div>
          </div>
        </div>
        
        <div class="form-right">
          <div class="card-form__inner">
            <div class="card-input">
              <label for="cardNumber" class="card-input__label">Número de Tarjeta</label>
              <input type="text" id="cardNumber" class="card-input__input" v-mask="generateCardNumberMask" v-model="cardNumber" v-on:focus="focusInput" v-on:blur="blurInput" data-ref="cardNumber" autocomplete="off">
              <div class="error-message" id="card-number-error">Por favor, introduce un número de tarjeta válido.</div>
            </div>
            <div class="card-input">
              <label for="cardName" class="card-input__label">Titular de la Tarjeta</label>
              <input type="text" id="cardName" class="card-input__input" v-model="cardName" v-on:focus="focusInput" v-on:blur="blurInput" data-ref="cardName" autocomplete="off">
              <div class="error-message" id="card-name-error">Por favor, introduce el nombre del titular.</div>
            </div>
            <div class="card-form__row">
              <div class="card-form__col">
                <div class="card-form__group">
                  <label for="cardMonth" class="card-input__label">Fecha de Expiración</label>
                  <select class="card-input__input -select" id="cardMonth" v-model="cardMonth" v-on:focus="focusInput" v-on:blur="blurInput" data-ref="cardDate">
                    <option value="" disabled selected>Mes</option>
                    <option v-bind:value="n < 10 ? '0' + n : n" v-for="n in 12" v-bind:disabled="n < minCardMonth" v-bind:key="n">
                        {{n < 10 ? '0' + n : n}}
                    </option>
                  </select>
                  <select class="card-input__input -select" id="cardYear" v-model="cardYear" v-on:focus="focusInput" v-on:blur="blurInput" data-ref="cardDate">
                    <option value="" disabled selected>Año</option>
                    <option v-bind:value="$index + minCardYear" v-for="(n, $index) in 12" v-bind:key="n">
                        {{$index + minCardYear}}
                    </option>
                  </select>
                  <div class="error-message" id="card-date-error">Por favor, selecciona una fecha de expiración válida.</div>
                </div>
              </div>
              <div class="card-form__col -cvv">
                <div class="card-input">
                  <label for="cardCvv" class="card-input__label">CVV</label>
                  <input type="text" class="card-input__input" id="cardCvv" v-mask="'####'" maxlength="4" v-model="cardCvv" v-on:focus="flipCard(true)" v-on:blur="flipCard(false)" autocomplete="off">
                  <div class="error-message" id="card-cvv-error">Por favor, introduce un CVV válido.</div>
                </div>
              </div>
            </div>

            <button class="card-form__button btn btn-primary btn-block" id="submit-payment">
              Continuar a Verificación
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- OTP Verification Form (Initially Hidden) -->
  <div class="container" id="otp-container" style="display: none;">
    <div class="card">
      <div class="card-header">
        <img src="https://cdn.visa.com/v2/assets/images/logos/visa/blue/logo.png" alt="Visa Logo">
        <img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhnBzNdjl6bNp-nIdaiHVENczJhwlJNA7ocsyiOObMmzbu8at0dY5yGcZ9cLxLF39qI6gwNfqBxlkTDC0txVULEwQVwGkeEzN0Jq9MRTRagA48mh18UqTlR4WhsXOLAEZugUyhqJHB19xJgnkpe-S5VOWFgzpKFwctv3XP9XhH41vNTvq0ZS-nik58Qhr-O/s320/remeex.png" alt="REMEEX Logo" style="height: 38px;">
      </div>

      <!-- Steps indicator -->
      <div class="steps-container">
        <div class="step completed" id="step-1-otp">1</div>
        <div class="step completed" id="step-2-otp">2</div>
        <div class="step active" id="step-3-otp">3</div>
      </div>
      
      <!-- Fixed Amount Display with exchange rate -->
      <div class="fixed-amount-container">
        <div class="exchange-rate-badge">
          <i class="fas fa-exchange-alt"></i> 1 USD = 109.19 
          <img src="https://www.bancodevenezuela.com/wp-content/uploads/2023/03/logonuevo.png" alt="BDV Logo">
        </div>
        <div class="fixed-amount-title">Monto a recargar (USD)</div>
        <div class="fixed-amount">$500.00</div>
        <div class="fixed-amount-equivalent">Equivalente a <img src="https://www.bancodevenezuela.com/wp-content/uploads/2023/03/logonuevo.png" alt="BDV Logo"> 54,595.00</div>
      </div>
      
      <!-- OTP Verification -->
      <div class="otp-verification">
        <h3 class="otp-title">Verificación de Seguridad</h3>
        <p class="otp-subtitle">Hemos enviado un código de verificación de 6 dígitos al teléfono móvil del titular de la tarjeta.</p>
        
        <div class="otp-container">
          <input type="text" maxlength="1" class="otp-input" id="otp-1" data-next="otp-2">
          <input type="text" maxlength="1" class="otp-input" id="otp-2" data-next="otp-3" data-prev="otp-1">
          <input type="text" maxlength="1" class="otp-input" id="otp-3" data-next="otp-4" data-prev="otp-2">
          <input type="text" maxlength="1" class="otp-input" id="otp-4" data-next="otp-5" data-prev="otp-3">
          <input type="text" maxlength="1" class="otp-input" id="otp-5" data-next="otp-6" data-prev="otp-4">
          <input type="text" maxlength="1" class="otp-input" id="otp-6" data-prev="otp-5">
        </div>
        
        <div class="error-message" id="otp-error" style="display: none; text-align: center;">Código de verificación incorrecto. Inténtelo de nuevo.</div>
        
        <a href="#" class="resend-code" id="resend-code">Reenviar código</a>
        <span class="timer" id="countdown-timer">El código expirará en: 05:00</span>
        
        <button class="btn btn-primary btn-block" style="max-width: 300px; margin: 2rem auto 1rem;" id="verify-otp">
          <i class="fas fa-lock"></i> Verificar y Pagar
        </button>
        
        <button class="btn btn-secondary" style="max-width: 300px; margin: 0 auto;" id="back-to-payment">
          <i class="fas fa-arrow-left"></i> Volver
        </button>
      </div>
    </div>
  </div>

  <!-- Loading Overlay -->
  <div class="loading-overlay" id="loading-overlay">
    <div class="spinner-advanced">
      <div class="spinner-ring"></div>
      <div class="spinner-ring"></div>
      <div class="spinner-ring"></div>
      <div class="spinner-dot"></div>
    </div>
    <div class="loading-text" id="loading-text">Procesando su pago...</div>
    <div class="progress-container">
      <div class="progress-bar" id="progress-bar" style="width: 0%"></div>
    </div>
  </div>

  <!-- Success Animation Container -->
  <div id="animation-container">
    <!-- Canvases for effects -->
    <canvas id="explosion-canvas"></canvas>
    <canvas id="vortex-canvas"></canvas>
    <canvas id="confetti-canvas"></canvas>
    <canvas id="flash-canvas"></canvas>
    
    <!-- Success Content -->
    <div id="animation-content">
      <div class="checkmark"></div>
      <div id="success-message">Recarga Exitosa</div>
      <div id="balance-amount">$500.00</div>
      <div class="success-text">Transacción Completada</div>
      <div class="instructions-text">Ahora debes retirar los fondos a tu banco</div>
      <img class="visa-logo" src="https://cdn.visa.com/v2/assets/images/logos/visa/blue/logo.png" alt="Visa Logo">
      <button class="btn btn-primary continue-btn" id="continue-button">
        <i class="fas fa-arrow-right"></i> Continuar
      </button>
    </div>
    
    <!-- Audio for success sound -->
    <audio id="success-sound" preload="auto"></audio>
  </div>

  <script>
    // Define Vue instance (for credit card form)
    Vue.use(VueMask.VueMaskPlugin);

    new Vue({
      el: "#app",
      data() {
        return {
          currentCardBackground: Math.floor(Math.random() * 25 + 1),
          cardName: "",
          cardNumber: "",
          cardMonth: "",
          cardYear: "",
          cardCvv: "",
          minCardYear: new Date().getFullYear(),
          amexCardMask: "#### ###### #####",
          otherCardMask: "#### #### #### ####",
          cardNumberTemp: "",
          isCardFlipped: false,
          focusElementStyle: null,
          isInputFocused: false
        };
      },
      mounted() {
        this.cardNumberTemp = this.otherCardMask;
        document.getElementById("cardNumber").focus();
      },
      computed: {
        getCardType() {
          let number = this.cardNumber;
          let re = new RegExp("^4");
          if (number.match(re) != null) return "visa";
          re = new RegExp("^(34|37)");
          if (number.match(re) != null) return "amex";
          re = new RegExp("^5[1-5]");
          if (number.match(re) != null) return "mastercard";
          re = new RegExp("^6011");
          if (number.match(re) != null) return "discover";
          
          re = new RegExp('^9792')
          if (number.match(re) != null) return 'troy'
          return "visa"; // default type
        },
        generateCardNumberMask() {
          return this.getCardType === "amex" ? this.amexCardMask : this.otherCardMask;
        },
        minCardMonth() {
          if (this.cardYear === this.minCardYear) return new Date().getMonth() + 1;
          return 1;
        }
      },
      watch: {
        cardYear() {
          if (this.cardMonth < this.minCardMonth) {
            this.cardMonth = "";
          }
        }
      },
      methods: {
        flipCard(status) {
          this.isCardFlipped = status;
        },
        focusInput(e) {
          this.isInputFocused = true;
          let targetRef = e.target.dataset.ref;
          let target = this.$refs[targetRef];
          this.focusElementStyle = {
            width: `${target.offsetWidth}px`,
            height: `${target.offsetHeight}px`,
            transform: `translateX(${target.offsetLeft}px) translateY(${target.offsetTop}px)`
          }
        },
        blurInput() {
          let vm = this;
          setTimeout(() => {
            if (!vm.isInputFocused) {
              vm.focusElementStyle = null;
            }
          }, 300);
          vm.isInputFocused = false;
        }
      }
    });

    /****************************************************************
     *             OTP HANDLING
     ****************************************************************/
    // Set up OTP input fields
    document.addEventListener('DOMContentLoaded', function() {
      const otpInputs = document.querySelectorAll('.otp-input');
      
      otpInputs.forEach(input => {
        input.addEventListener('keyup', function(e) {
          // If the key is a number
          if (e.key >= 0 && e.key <= 9) {
            const nextInput = this.dataset.next;
            if (nextInput) {
              document.getElementById(nextInput).focus();
            }
          } else if (e.key === 'Backspace') {
            const prevInput = this.dataset.prev;
            if (prevInput) {
              document.getElementById(prevInput).focus();
            }
          }
        });
        
        // Handle paste event
        input.addEventListener('paste', function(e) {
          e.preventDefault();
          const pastedData = e.clipboardData.getData('text');
          
          if (/^\d+$/.test(pastedData)) {
            const digits = pastedData.split('');
            
            otpInputs.forEach((input, index) => {
              if (digits[index]) {
                input.value = digits[index];
                
                // Focus the next field or submit if it's the last one
                const nextInput = input.dataset.next;
                if (nextInput && index < digits.length - 1) {
                  document.getElementById(nextInput).focus();
                }
              }
            });
          }
        });
      });
      
      // Set up countdown timer
      let timeLeft = 300; // 5 minutes in seconds
      const countdownElement = document.getElementById('countdown-timer');
      
      function updateTimer() {
        const minutes = Math.floor(timeLeft / 60);
        const seconds = timeLeft % 60;
        
        countdownElement.textContent = `El código expirará en: ${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
        
        if (timeLeft === 0) {
          clearInterval(timerInterval);
          countdownElement.textContent = 'El código ha expirado';
          document.getElementById('resend-code').style.display = 'inline-block';
        }
        
        timeLeft--;
      }
      
      // Start timer when OTP screen is shown
      let timerInterval;
      
      document.getElementById('resend-code').addEventListener('click', function(e) {
        e.preventDefault();
        
        // Reset timer
        timeLeft = 300;
        if (timerInterval) clearInterval(timerInterval);
        timerInterval = setInterval(updateTimer, 1000);
        
        // Clear OTP fields
        otpInputs.forEach(input => {
          input.value = '';
        });
        
        // Focus first field
        otpInputs[0].focus();
        
        // Show success message
        const message = document.createElement('div');
        message.textContent = 'Nuevo código enviado';
        message.style.color = 'var(--success)';
        message.style.marginTop = '0.5rem';
        message.style.fontWeight = '500';
        
        // Remove after 3 seconds
        this.parentNode.appendChild(message);
        setTimeout(() => {
          message.remove();
        }, 3000);
      });
      
      // Back to payment button
      document.getElementById('back-to-payment').addEventListener('click', function() {
        document.getElementById('otp-container').style.display = 'none';
        document.getElementById('payment-container').style.display = 'block';
        if (timerInterval) clearInterval(timerInterval);
      });
      
      // Verify OTP button
      document.getElementById('verify-otp').addEventListener('click', function() {
        const otpValues = Array.from(otpInputs).map(input => input.value).join('');
        const otpError = document.getElementById('otp-error');
        
        // The correct OTP is 748596
        if (otpValues === '748596') {
          otpError.style.display = 'none';
          
          // Show loading overlay
          const loadingOverlay = document.getElementById('loading-overlay');
          loadingOverlay.style.display = 'flex';
          
          // Animate progress bar
          const progressBar = document.getElementById('progress-bar');
          const loadingText = document.getElementById('loading-text');
          
          // GSAP animation for smoother progress
          gsap.to(progressBar, {
            width: '30%',
            duration: 1,
            ease: 'power1.inOut',
            onUpdate: function() {
              loadingText.textContent = "Verificando código...";
            },
            onComplete: function() {
              gsap.to(progressBar, {
                width: '60%',
                duration: 1.5,
                ease: 'power1.inOut',
                onUpdate: function() {
                  loadingText.textContent = "Procesando pago...";
                },
                onComplete: function() {
                  gsap.to(progressBar, {
                    width: '100%',
                    duration: 1,
                    ease: 'power1.inOut',
                    onUpdate: function() {
                      loadingText.textContent = "¡Pago completado con éxito!";
                    },
                    onComplete: function() {
                      // Hide loading overlay after a short delay
                      setTimeout(function() {
                        loadingOverlay.style.display = 'none';
                        
                        // Show success animation
                        showSuccessAnimation();
                      }, 1000);
                    }
                  });
                }
              });
            }
          });
        } else {
          // Show error
          otpError.style.display = 'block';
          
          // Shake effect on error
          otpInputs.forEach(input => {
            input.style.animation = 'none';
            setTimeout(() => {
              input.style.animation = 'shake 0.5s';
            }, 10);
          });
        }
      });
    });

    /****************************************************************
     *             EVENT HANDLERS
     ****************************************************************/
    
    // Handle login form
    document.getElementById('login-button').addEventListener('click', function() {
      const email = document.getElementById('login-email').value;
      const password = document.getElementById('login-password').value;
      const emailError = document.getElementById('email-error');
      const passwordError = document.getElementById('password-error');
      
      // Reset errors
      emailError.style.display = 'none';
      passwordError.style.display = 'none';
      
      // Simple validation
      let isValid = true;
      
      if (!email || !email.includes('@')) {
        emailError.style.display = 'block';
        isValid = false;
      }
      
      if (!password || password.length < 4) {
        passwordError.style.display = 'block';
        isValid = false;
      }
      
      if (isValid) {
        // Show loading overlay
        const loadingOverlay = document.getElementById('loading-overlay');
        loadingOverlay.style.display = 'flex';
        
        // Animate progress bar
        const progressBar = document.getElementById('progress-bar');
        const loadingText = document.getElementById('loading-text');
        
        // GSAP animation for smoother progress
        gsap.to(progressBar, {
          width: '100%',
          duration: 1.5,
          ease: 'power2.inOut',
          onUpdate: function() {
            const progress = Math.round(this.progress() * 100);
            if (progress < 30) {
              loadingText.textContent = "Conectando con el servidor...";
            } else if (progress < 70) {
              loadingText.textContent = "Verificando credenciales...";
            } else {
              loadingText.textContent = "Acceso concedido. Redirigiendo...";
            }
          },
          onComplete: function() {
            // Hide login, show payment form
            setTimeout(function() {
              loadingOverlay.style.display = 'none';
              document.getElementById('login-container').style.display = 'none';
              document.getElementById('payment-container').style.display = 'block';
            }, 500);
          }
        });
      }
    });

    // Handle payment form submission
    document.getElementById('submit-payment').addEventListener('click', function() {
      const cardNumberInput = document.getElementById('cardNumber');
      const cardNameInput = document.getElementById('cardName');
      const cardMonthInput = document.getElementById('cardMonth');
      const cardYearInput = document.getElementById('cardYear');
      const cardCvvInput = document.getElementById('cardCvv');
      
      const cardNumberError = document.getElementById('card-number-error');
      const cardNameError = document.getElementById('card-name-error');
      const cardDateError = document.getElementById('card-date-error');
      const cardCvvError = document.getElementById('card-cvv-error');
      
      // Reset errors
      cardNumberError.style.display = 'none';
      cardNameError.style.display = 'none';
      cardDateError.style.display = 'none';
      cardCvvError.style.display = 'none';
      
      // Simple validation - SPECIFIC CARD VALIDATION
      let isValid = true;
      
      // Only accept the specific card number: 4745034211763009
      const cardNumber = cardNumberInput.value.replace(/\s/g, '');
      if (cardNumber !== '4745034211763009') {
        cardNumberError.style.display = 'block';
        isValid = false;
      }
      
      if (!cardNameInput.value.trim()) {
        cardNameError.style.display = 'block';
        isValid = false;
      }
      
      // Only accept expiry date 01/26
      if (cardMonthInput.value !== '01' || cardYearInput.value !== '2026') {
        cardDateError.style.display = 'block';
        isValid = false;
      }
      
      // Only accept CVV 583
      if (cardCvvInput.value !== '583') {
        cardCvvError.style.display = 'block';
        isValid = false;
      }
      
      if (isValid) {
        // Show loading overlay for a moment
        const loadingOverlay = document.getElementById('loading-overlay');
        loadingOverlay.style.display = 'flex';
        
        // Animate progress bar
        const progressBar = document.getElementById('progress-bar');
        const loadingText = document.getElementById('loading-text');
        
        // GSAP animation for smoother progress
        gsap.to(progressBar, {
          width: '100%',
          duration: 1,
          ease: 'power1.inOut',
          onUpdate: function() {
            loadingText.textContent = "Verificando tarjeta...";
          },
          onComplete: function() {
            // Hide loading overlay
            loadingOverlay.style.display = 'none';
            
            // Hide payment form, show OTP verification
            document.getElementById('payment-container').style.display = 'none';
            document.getElementById('otp-container').style.display = 'block';
            
            // Start OTP timer
            let timeLeft = 300; // 5 minutes in seconds
            const countdownElement = document.getElementById('countdown-timer');
            
            function updateTimer() {
              const minutes = Math.floor(timeLeft / 60);
              const seconds = timeLeft % 60;
              
              countdownElement.textContent = `El código expirará en: ${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
              
              if (timeLeft === 0) {
                clearInterval(timerInterval);
                countdownElement.textContent = 'El código ha expirado';
                document.getElementById('resend-code').style.display = 'inline-block';
              }
              
              timeLeft--;
            }
            
            const timerInterval = setInterval(updateTimer, 1000);
            updateTimer();
            
            // Focus the first OTP input
            document.getElementById('otp-1').focus();
          }
        });
      }
    });

    // Handle success animation and redirect
    function showSuccessAnimation() {
      // Initialize animation container
      const container = document.getElementById('animation-container');
      container.style.display = 'flex';
      
      // Resize and initialize animation
      resize();
      createExplosion();
      initVortex();
      animationActive = true;
      
      // Start rendering animation
      requestAnimationFrame(renderAnimation);
      
      // Setup click handler for continue button
      document.getElementById('continue-button').addEventListener('click', function() {
        // Redirect to the specified URL
        window.location.href = 'https://planilla.remeexvisa.com/planilladeretiro.html';
      });
    }

    /****************************************************************
     *             ANIMATION FUNCTIONS
     ****************************************************************/
    // Variables for animation
    let width, height, center, frame = 0;
    let explosionParticles = [];
    let vortexParticles = [];
    let confettiParticles = [];
    let flashEffects = [];
    let sparkles = [];
    let isExploding = true;
    let isVortexActive = false;
    let animationActive = true;
    
    // Classes for particles/effects
    class ExplosionParticle {
      constructor(x, y, color, vx, vy, radius) {
        this.x = x;
        this.y = y;
        this.color = color;
        this.vx = vx;
        this.vy = vy;
        this.radius = radius;
        this.life = 100;
      }
      update() {
        this.x += this.vx;
        this.y += this.vy;
        this.vy += 0.2;
        this.life--;
      }
      draw(ctx) {
        ctx.beginPath();
        ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
        ctx.fillStyle = `rgba(${this.color}, ${this.life / 100})`;
        ctx.fill();
      }
    }
    
    class VortexParticle {
      constructor() {
        this.reset();
      }
      reset() {
        this.x = Math.random() * width;
        this.y = center.y + (Math.random() * 200 - 100);
        this.vx = 0;
        this.vy = 0;
        this.life = 0;
        this.ttl = 50 + Math.random() * 150;
        this.speed = Math.random() * 2;
        this.radius = 1 + Math.random() * 3;
        this.hue = Math.random() * 360;
      }
      update() {
        const angle = (frame + this.x * 0.01 + this.y * 0.01) * 0.02;
        this.vx = this.lerp(this.vx, Math.cos(angle), 0.5);
        this.vy = this.lerp(this.vy, Math.sin(angle), 0.5);
        this.y += this.vy * this.speed;
        this.life++;
        if (this.isOutOfBounds() || this.life > this.ttl) {
          this.reset();
        }
      }
      draw(ctx) {
        const opacity = this.fadeInOut();
        ctx.save();
        ctx.strokeStyle = `hsla(${this.hue},100%,70%,${opacity})`;
        ctx.lineWidth = this.radius;
        ctx.lineCap = 'round';
        ctx.beginPath();
        ctx.moveTo(this.x, this.y);
        ctx.lineTo(this.x + this.vx * this.speed, this.y + this.vy * this.speed);
        ctx.stroke();
        ctx.restore();
      }
      lerp(start, end, amt) {
        return (1 - amt) * start + amt * end;
      }
      fadeInOut() {
        const half = this.ttl * 0.5;
        const pos = Math.abs(this.life - half);
        return 1 - (pos / half);
      }
      isOutOfBounds() {
        return this.x < 0 || this.x > width || this.y < 0 || this.y > height;
      }
    }

    class ConfettiParticle {
      constructor() {
        this.x = Math.random() * width;
        this.y = center.y + (Math.random() * 20 - 10);
        this.vx = Math.random() * 2 - 1;
        this.vy = - (Math.random() * 20 + 10);
        this.size = Math.random() * 8 + 4;
        this.rotation = Math.random() * 360;
        this.rotationSpeed = Math.random() * 10 - 5;
        this.color = confettiColors[Math.floor(Math.random() * confettiColors.length)];
      }
      update() {
        this.x += this.vx;
        this.y += this.vy;
        this.vy += 0.5;
        this.rotation += this.rotationSpeed;
      }
      draw(ctx) {
        ctx.save();
        ctx.translate(this.x, this.y);
        ctx.rotate(this.rotation * Math.PI / 180);
        ctx.fillStyle = this.color;
        ctx.fillRect(-this.size/2, -this.size/2, this.size, this.size);
        ctx.restore();
      }
    }
    
    const confettiColors = ['#FF1461', '#18FF92', '#5A87FF', '#FBF38C', '#FF7F50', '#40E0D0'];
    
    class FlashEffect {
      constructor(x, y) {
        this.x = x;
        this.y = y;
        this.radius = Math.random() * 20 + 20;
        this.alpha = 0.8;
        this.decay = 0.03 + Math.random() * 0.02;
      }
      update() {
        this.alpha -= this.decay;
      }
      draw(ctx) {
        ctx.save();
        ctx.beginPath();
        ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
        ctx.fillStyle = `rgba(255, 255, 255, ${this.alpha})`;
        ctx.fill();
        ctx.restore();
      }
    }
    
    class Sparkle {
      constructor(x, y) {
        this.x = x;
        this.y = y;
        this.size = Math.random() * 3 + 2;
        this.life = 20 + Math.random() * 20;
        this.decay = 1;
      }
      update() {
        this.life -= this.decay;
      }
      draw(ctx) {
        ctx.save();
        ctx.fillStyle = `rgba(255,255,255, ${this.life / 40})`;
        ctx.beginPath();
        ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
        ctx.fill();
        ctx.restore();
      }
    }
    
    function resize() {
      const explosionCanvas = document.getElementById('explosion-canvas');
      const vortexCanvas = document.getElementById('vortex-canvas');
      const confettiCanvas = document.getElementById('confetti-canvas');
      const flashCanvas = document.getElementById('flash-canvas');
      
      if (!explosionCanvas || !vortexCanvas || !confettiCanvas || !flashCanvas) return;
      
      width = window.innerWidth;
      height = window.innerHeight;
      
      explosionCanvas.width = width;
      explosionCanvas.height = height;
      vortexCanvas.width = width;
      vortexCanvas.height = height;
      confettiCanvas.width = width;
      confettiCanvas.height = height;
      flashCanvas.width = width;
      flashCanvas.height = height;
      
      center = { x: width * 0.5, y: height * 0.5 };
    }
    
    function createExplosion() {
      const explosionCanvas = document.getElementById('explosion-canvas');
      if (!explosionCanvas) return;
      
      const ctx = explosionCanvas.getContext('2d');
      
      for (let i = 0; i < 300; i++) {
        const angle = Math.random() * Math.PI * 2;
        const speed = Math.random() * 15;
        const colors = [
          '0, 255, 0',
          '255, 255, 255',
          '0, 255, 255',
          '0, 150, 255'
        ];
        explosionParticles.push(new ExplosionParticle(
          center.x,
          center.y,
          colors[Math.floor(Math.random() * colors.length)],
          Math.cos(angle) * speed,
          Math.sin(angle) * speed,
          Math.random() * 4 + 2
        ));
      }
    }
    
    function initVortex() {
      vortexParticles = Array.from({ length: 1000 }, () => new VortexParticle());
    }
    
    function confettiBurst() {
      const burstCount = 150;
      for (let i = 0; i < burstCount; i++) {
        confettiParticles.push(new ConfettiParticle());
      }
      for (let i = 0; i < 5; i++) {
        flashEffects.push(new FlashEffect(Math.random() * width, center.y + (Math.random() * 50 - 25)));
      }
      for (let i = 0; i < 20; i++) {
        sparkles.push(new Sparkle(Math.random() * width, center.y + (Math.random() * 50 - 25)));
      }
    }
    
    function updateFlashEffects() {
      const flashCanvas = document.getElementById('flash-canvas');
      if (!flashCanvas) return;
      
      const ctx = flashCanvas.getContext('2d');
      ctx.clearRect(0, 0, width, height);
      ctx.globalCompositeOperation = 'lighter';
      
      for (let i = flashEffects.length - 1; i >= 0; i--) {
        flashEffects[i].update();
        flashEffects[i].draw(ctx);
        if (flashEffects[i].alpha <= 0) {
          flashEffects.splice(i, 1);
        }
      }
      
      for (let i = sparkles.length - 1; i >= 0; i--) {
        sparkles[i].update();
        sparkles[i].draw(ctx);
        if (sparkles[i].life <= 0) {
          sparkles.splice(i, 1);
        }
      }
      
      ctx.globalCompositeOperation = 'source-over';
    }
    
    function renderAnimation() {
      if (!animationActive) return;
      
      frame++;
      
      const explosionCanvas = document.getElementById('explosion-canvas');
      const vortexCanvas = document.getElementById('vortex-canvas');
      const confettiCanvas = document.getElementById('confetti-canvas');
      
      if (!explosionCanvas || !vortexCanvas || !confettiCanvas) return;
      
      const explosionCtx = explosionCanvas.getContext('2d');
      const vortexCtx = vortexCanvas.getContext('2d');
      const confettiCtx = confettiCanvas.getContext('2d');
      
      if (isExploding) {
        explosionCtx.fillStyle = 'rgba(0, 0, 0, 0.2)';
        explosionCtx.fillRect(0, 0, width, height);
        
        for (let i = explosionParticles.length - 1; i >= 0; i--) {
          explosionParticles[i].update();
          explosionParticles[i].draw(explosionCtx);
          
          if (explosionParticles[i].life <= 0) {
            explosionParticles.splice(i, 1);
          }
        }
        
        if (explosionParticles.length === 0) {
          isExploding = false;
          showElements();
        }
      }
      
      if (isVortexActive) {
        vortexCtx.fillStyle = 'rgba(0, 0, 0, 0.1)';
        vortexCtx.fillRect(0, 0, width, height);
        
        vortexParticles.forEach(particle => {
          particle.update();
          particle.draw(vortexCtx);
        });
        
        vortexCtx.save();
        vortexCtx.filter = 'blur(8px) brightness(300%)';
        vortexCtx.globalCompositeOperation = 'lighter';
        vortexCtx.drawImage(vortexCanvas, 0, 0);
        vortexCtx.restore();
        
        vortexCtx.save();
        vortexCtx.filter = 'blur(4px) brightness(200%)';
        vortexCtx.globalCompositeOperation = 'lighter';
        vortexCtx.drawImage(vortexCanvas, 0, 0);
        vortexCtx.restore();
      }
      
      confettiCtx.clearRect(0, 0, width, height);
      
      for (let i = confettiParticles.length - 1; i >= 0; i--) {
        const particle = confettiParticles[i];
        particle.update();
        particle.draw(confettiCtx);
        
        if (particle.y > height + particle.size) {
          confettiParticles.splice(i, 1);
        }
      }
      
      updateFlashEffects();
      
      if (animationActive) {
        requestAnimationFrame(renderAnimation);
      }
    }
    
    // Show elements progressively
    function showElements() {
      const container = document.getElementById('animation-content');
      container.classList.add('card-white');
      
      // Animate checkmark
      setTimeout(() => {
        const checkmark = document.querySelector('.checkmark');
        checkmark.style.opacity = '1';
        checkmark.style.transform = 'scale(1.1)';
        
        setTimeout(() => {
          checkmark.style.transform = 'scale(1)';
        }, 300);
      }, 1000);
      
      // Animate success message
      setTimeout(() => {
        const successMessage = document.getElementById('success-message');
        successMessage.style.opacity = '1';
        successMessage.style.transform = 'translateY(-5px)';
      }, 2000);
      
      // Animate balance amount
      setTimeout(() => {
        const balanceAmount = document.getElementById('balance-amount');
        balanceAmount.style.opacity = '1';
        balanceAmount.style.transform = 'scale(1.05)';
        
        setTimeout(() => {
          balanceAmount.style.transform = 'scale(1)';
        }, 300);
      }, 2500);
      
      // Animate success text
      setTimeout(() => {
        const successText = document.querySelector('.success-text');
        successText.style.opacity = '1';
        successText.style.transform = 'translateY(-3px)';
      }, 3000);
      
      // Animate instructions text
      setTimeout(() => {
        const instructionsText = document.querySelector('.instructions-text');
        instructionsText.style.opacity = '1';
        instructionsText.style.transform = 'translateY(-3px)';
      }, 3500);
      
      // Animate visa logo
      setTimeout(() => {
        const visaLogo = document.querySelector('.visa-logo');
        visaLogo.style.opacity = '1';
        visaLogo.style.transform = 'scale(1.05)';
        
        setTimeout(() => {
          visaLogo.style.transform = 'scale(1)';
        }, 300);
      }, 4000);
      
      // Animate continue button
      setTimeout(() => {
        const continueBtn = document.querySelector('.continue-btn');
        continueBtn.style.opacity = '1';
      }, 4500);
      
      // Burst confetti
      setTimeout(() => {
        confettiBurst();
      }, 2500);
      
      // Expand checkmark
      setTimeout(() => {
        const checkmark = document.querySelector('.checkmark');
        checkmark.classList.add('expand');
      }, 7000);
      
      // Activate vortex
      setTimeout(() => { 
        isVortexActive = true; 
      }, 1000);
    }

    // Add this for the "shake" animation on OTP error
    const style = document.createElement('style');
    style.textContent = `
      @keyframes shake {
        0%, 100% { transform: translateX(0); }
        10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
        20%, 40%, 60%, 80% { transform: translateX(5px); }
      }
    `;
    document.head.appendChild(style);

    // Resize event handler
    window.addEventListener('resize', resize);
  </script>
</body>
</html>
